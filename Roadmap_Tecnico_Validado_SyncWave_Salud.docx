Roadmap T√©cnico Validado ‚Äî SyncWave Salud

Fecha: 2025-11-11
Autor: Generado autom√°ticamente

Resumen ejecutivo
- Progreso global estimado: 76%
- Fortalezas: Autenticaci√≥n/RBAC, gesti√≥n de pacientes, agenda (m√©dico), consultas, generaci√≥n de recetas, notificaciones, onboarding/invites, dashboards (m√©dico/clinica).
- Principales pendientes: Integraci√≥n y UI/API de Farmacia (pharmacy_order, dispensing), M√≥dulo Laboratorio (orders/results/webhooks), Facturaci√≥n/Invoices completos, reportes y QA E2E finales.
- Estimaci√≥n tiempo restante (3‚Äì5 devs fullstack, trabajo en paralelo): 6‚Äì10 semanas (recomendado objetivo: 8 semanas = 4 sprints de 2 semanas).

1) Cl√≠nica / Organizaci√≥n
| Funcionalidad | Estado | Archivo / Ruta (ejemplos) | Comentario |
|---------------|--------|---------------------------|-----------|
| Gesti√≥n de perfil cl√≠nica | ‚úÖ | src/app/dashboard/clinic/profile/page.tsx, src/app/api/clinic-profile/route.ts | Profile y API implementados |
| Gesti√≥n de especialistas / invitaciones | ‚úÖ | src/app/dashboard/clinic/specialists/page.tsx, src/app/dashboard/clinic/invites/page.tsx, src/app/api/invites/* | Invites implementados |
| Gesti√≥n de pacientes (nivel org) | ‚úÖ | src/app/api/patients/route.ts, src/components/PatientsGrid.tsx | CRUD y componentes presentes |
| Agenda general / citas por sede | üü° | src/app/api/appointments/route.ts, src/app/dashboard/clinic/page.tsx | Citas funcionan; falta agenda clinic-wide avanzada |
| Configuraci√≥n y settings | ‚úÖ | src/app/dashboard/clinic/settings/page.tsx, src/app/api/clinic/route.ts | Implementado |
| Control inventario / farmacia interna | ‚ùå | ‚Äî | DB tiene tablas; no hay API/UI implementados |
| Facturaci√≥n & pagos (b√°sico) | üü° | src/lib/stripe.ts, components/PlanCard.tsx | Stripe lib y planes; invoices API incompleta |
| Reportes administrativos | üü° | src/app/api/dashboard/medic/kpis/route.ts | KPIs m√©dicos; reportes clinic-wide limitados |

2) M√©dico / Especialista
| Funcionalidad | Estado | Archivo / Ruta | Comentario |
|---------------|--------|----------------|-----------|
| Dashboard personal | ‚úÖ | src/app/dashboard/medic/page.tsx, src/app/dashboard/medic/layout.tsx | Implementado |
| Agenda (ver/gestionar citas) | ‚úÖ | src/app/dashboard/medic/citas/page.tsx, AppointmentList.tsx | Funcional |
| Registro de consultas / notas | ‚úÖ | src/app/api/consultations/route.ts, src/app/dashboard/medic/consultas/* | Crear/editar notas implementado |
| Generaci√≥n de recetas electr√≥nicas | ‚úÖ | src/app/dashboard/medic/consultas/[id]/prescription/*, src/app/api/medic/prescriptions/route.ts | Implementado |
| Solicitar/visualizar resultados de laboratorio | ‚ùå | ‚Äî | DB tiene lab_result; falta API/UI laboratorios |
| Comunicaci√≥n interna / mensajes | ‚úÖ | src/components/patient/Chat.tsx, src/app/api/notifications/route.ts | Chat y notificaciones presentes |
| Reportes de productividad (m√©dico) | ‚úÖ | src/app/api/dashboard/medic/kpis/route.ts | KPIs disponibles |

3) Paciente
| Funcionalidad | Estado | Archivo / Ruta | Comentario |
|---------------|--------|----------------|-----------|
| Portal paciente (vista) | ‚úÖ | src/app/dashboard/patient/page.tsx | Implementado |
| CRUD / historial (paciente) | ‚úÖ | src/app/api/patients/route.ts, src/app/dashboard/medic/pacientes/[id]/page.tsx | Historial accesible |
| Solicitar / cancelar citas (API) | üü° | src/app/api/appointments/route.ts | API existe; UI de solicitud parcial |
| Recepci√≥n de notificaciones / recordatorios | ‚úÖ | src/app/api/notifications/route.ts, lib/mailer.ts | Implementado |
| Descarga de recetas / informes | üü° | src/app/dashboard/medic/consultas/[id]/page.tsx | Descarga parcial; endpoints de archivos requieren confirmaci√≥n |
| Comunicaci√≥n (chat) | ‚úÖ | src/components/patient/Chat.tsx | Implementado |

4) Farmacia
| Funcionalidad | Estado | Archivo / Ruta | Comentario |
|---------------|--------|----------------|-----------|
| Recepci√≥n de recetas electr√≥nicas | üü° | src/app/api/prescriptions/route.ts | Endpoint de prescripciones existe; falta flujo PharmacyOrder |
| Validaci√≥n y confirmaci√≥n de recetas | ‚ùå | ‚Äî | No hay webhooks ni UI farmacia |
| Inventario y control de stock | ‚ùå | ‚Äî | DB: pharmacy_inventory; no hay API/UI |
| Registro de dispensaci√≥n | ‚ùå | ‚Äî | prescription_dispense no expuesto en API |
| Reportes farmacia | ‚ùå | ‚Äî | No implementado |

5) Laboratorio
| Funcionalidad | Estado | Archivo / Ruta | Comentario |
|---------------|--------|----------------|-----------|
| Generaci√≥n de √≥rdenes desde consulta | ‚ùå | ‚Äî | No se detect√≥ endpoint lab orders |
| Carga de resultados / attachments | ‚ùå | ‚Äî | lab_result table existe; falta API |
| Notificaci√≥n autom√°tica de resultados | üü° | src/app/api/notifications/route.ts | Notifications existen; falta integraci√≥n lab‚Üínotif |
| Control de muestras / reactivos | ‚ùå | ‚Äî | No implementado |

Mapeo de archivos relevantes (selecci√≥n)
- Auth: src/app/api/auth/me/route.ts, src/app/api/auth/profile/route.ts, src/lib/auth.ts, middleware.ts
- Pacientes: src/app/api/patients/route.ts, src/app/dashboard/medic/pacientes/*
- Citas: src/app/api/appointments/route.ts, src/app/dashboard/medic/citas/*
- Consultas: src/app/api/consultations/route.ts, src/app/dashboard/medic/consultas/*
- Recetas: src/app/api/prescriptions/route.ts, src/app/dashboard/medic/consultas/[id]/prescription/*
- Notificaciones: src/app/api/notifications/route.ts, src/lib/mailer.ts
- Clinic admin: src/app/dashboard/clinic/*, src/app/api/clinic-profile/route.ts
- Pagos: src/lib/stripe.ts, components/PlanCard.tsx
- DB/ORM: prisma/schema.prisma, src/lib/prisma.ts
- Integraciones/adapter: src/app/adapters/*, src/lib/supabaseClient.ts

Flujos paso a paso (resumen)

M√©dico
1. Inicia sesi√≥n.
2. Accede a /dashboard/medic.
3. Revisa agenda ‚Üí /dashboard/medic/citas.
4. Abre cita ‚Üí crea/edita consulta ‚Üí /api/consultations.
5. Genera receta ‚Üí /api/medic/prescriptions.
6. Notifica paciente ‚Üí /api/notifications.
7. (Pendiente) Enviar orden laboratorio ‚Üí /api/lab/orders.

Paciente
1. Registra cuenta / acepta invitaci√≥n.
2. Accede a /dashboard/patient.
3. Solicita cita (API parcial).
4. Asiste a consulta; recibe receta y notificaciones.
5. Descarga receta/informe (descarga parcial).

Cl√≠nica / Admin
1. Configura profile y settings.
2. Invita especialistas (invites).
3. Administra pacientes y revisa KPIs.
4. (Pendiente) Gestiona inventario y facturaci√≥n completa.

Farmacia (objetivo deseado)
1. Recibe receta (webhook/API).
2. Valida y confirma o reporta faltantes.
3. Dispensa y registra prescription_dispense.
4. Actualiza pharmacy_inventory.

Laboratorio (objetivo deseado)
1. Recibe orden desde consulta.
2. Registra muestra y procesa.
3. Sube resultado a lab_result y notifica.

Porcentajes estimados de completitud (por rol)
- M√©dico: 88%
- Cl√≠nica / Organizaci√≥n: 72%
- Paciente: 70%
- Farmacia: 5%
- Laboratorio: 5%
- Infra / soporte: 90%
Progreso global ponderado: ~76%

Dependencias cruzadas cr√≠ticas
- Prescripciones ‚Üî Farmacia: PharmacyOrder + webhooks.
- Consultas ‚Üî Laboratorio: LabOrders + LabResults + webhooks.
- Citas/Consultas ‚Üî Facturaci√≥n: invoices endpoint y relaci√≥n con facturacion table.
- Notificaciones central: triggers desde lab/pharmacy modules.
- Storage de archivos: prescripci√≥n y adjuntos de laboratorio (signed URLs).

Estimaci√≥n de tiempo y plan de sprints (recomendado)
Asunci√≥n: equipo 3‚Äì5 devs fullstack. Sprints de 2 semanas.

Sprint A (2w)
- Pharmacy API (pharmacy_order, prescription_dispense) + UI b√°sica farmacia.
Sprint B (2w)
- LabOrders API + lab_result upload + UI laboratorio + notif triggers.
Sprint C (2w)
- Invoices API ligado a appointment/facturacion + Stripe flow.
Sprint D (2w)
- QA E2E, fixes, seguridad, docs OpenAPI + webhooks sandbox.

Total estimado: 8 semanas (rango 6‚Äì10 semanas con margen).

Prioridades
1. Pharmacy API + UI
2. Lab Orders + Results + notif triggers
3. Facturaci√≥n/Invoices + pagos
4. Patient booking UI polish
5. QA E2E y documentaci√≥n (OpenAPI/webhooks)

Recomendaciones t√©cnicas
- A√±adir endpoints: /api/pharmacy/orders, /api/pharmacy/orders/{id}/confirm, /api/lab/orders, /api/lab/results.
- Workers/colas: Redis + BullMQ para procesar notificaciones as√≠ncronas.
- Storage: S3/MinIO con signed URLs.
- Publicar OpenAPI y crear sandbox para integraciones.
- Suite E2E (Cypress/Playwright) con tests cr√≠ticos (receta‚Üífarmacia, orden‚Üílab).

Pr√≥ximos pasos sugeridos
- Ejecutar sprints planificados y abrir issues por historia.
- Implementar y documentar contratos webhook para farmacias/labs.
- Ejecutar pruebas de integraci√≥n con 1 farmacia y 1 laboratorio piloto.
- Completar cobertura de tests y despliegue a staging.

Fin del documento.